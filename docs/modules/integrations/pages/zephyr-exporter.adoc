= Zephyr Exporter

Zephyr Exporter is a tool used for exporting test execution results into Jira Zephyr Plugin.

Features:

* Create test cases
* Update test cases
* Create test executions
* Set test execution statuses

include::partial$jira-configuration.adoc[]

== Zephyr Export Properties

[cols="1,2,3", options="header"]
|===

|Property
|Required
|Description

|`zephyr-exporter.export-results`
|true
|Property regulates if test entity export is needed

|`zephyr-exporter.test-entity`
|false
|Test entity export level. STORY or SCENARIO level

|`zephyr-exporter.jira-instance-key`
|false
|The key of the configured JIRA instance, in case of missing value it will be evaluated automatically based on issue keys being exported

|`zephyr-exporter.source-directory`
|true
|Path to directory with test execution JSON results and test entity.

|`zephyr-exporter.update-execution-statuses-only`
|false
|Property for update existing executions statuses only.

|`zephyr-exporter.update-test-cases`
|false
|Property to update existing test cases. User with update status permissions required in order to work.

|`zephyr-exporter.status-for-updated-test-cases`
|false
|Property defines status which will be set for all updated tests ("Backlog" by default).

|`zephyr-exporter.statuses-of-test-cases-to-add-to-execution`
|false
|List of test case statuses for adding to execution.

|`zephyr.project-key`
|true
|Key of a Jira project where new test executions should be created

|`zephyr.version-name`
|true
|Version/release name where new test executions should be created

|`zephyr.cycle-name`
|true
|Cycle/sprint name where new test executions should be created

|`zephyr.folder-name`
|false
|Folder name where new test executions should be created

|===

== Jira Fields Mapping

The Zephyr is a Jira plugin that uses custom Jira fields for it's data, one of the ways to find out custom field names for particular field used by Zephyr on Jira UI (if access to Jira configuration is prohibited) is to request description of some issue.

=== Test Case Properties

image::zephyr.png[]
[cols="1,2", options="header"]
|===

|Property
|Description

|`jira.<jira-instance-key>.fields-mapping.story-type`
|Key of a custom field which contains story type (Task)

|===

include::partial$authentication.adoc[]

== Zephyr Execution Status Mapping

The Zephyr plugin for Jira has own configurable execution statuses. testExecutionStatus endpoint is used to get the detailed information about the statuses, like: https://jira.example.com/rest/zapi/latest/util/testExecutionStatus. The following properties are used to setup a mapping between Vividus and Zephyr execution statuses.

[cols="1,2", options="header"]
|===

|Vividus execution status property name
|Zephyr execution status value (by default)

|`zephyr.statuses.FAILED`
|FAILED

|`zephyr.statuses.BROKEN`
|TEST NEEDS REWORK

|`zephyr.statuses.PENDING`
|TEST NEEDS REWORK

|`zephyr.statuses.UNKNOWN`
|PASSED WITH REMARKS

|`zephyr.statuses.SKIPPED`
|SCHEDULED

|`zephyr.statuses.PASSED`
|PASSED

|===

include::partial$authentication.adoc[]

== Scenario Meta Attributes

[cols="2,2,3", options="header"]
|===

|Name
|Example
|Description

|`testCaseId`
|`@testCaseId TEST-1`
|Add test execution to Jira test case

|===

== Example of scenario for export

.Test.story
[source,gherkin]
----
Scenario: Buy an item
Meta:
    @layout desktop chrome_phone
    @testCaseId TEST-1; TEST-2; TEST-3

Given I am on a page with the URL '${vividus-test-site-url}/delayedScroll.html'
When I click on element located `By.id(anchor)`
When I wait until scroll is finished
Then page is scrolled to element located `id(toClick)`
----

:service-key: zephyr

include::partial$export.adoc[]
